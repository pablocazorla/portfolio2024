---
import Container from "@/components/container/index.astro";
import ScrollDownBanner from "@/components/scrollDownBanner/index.astro";
import Button from "@/components/button/index.astro";
import ArrowRightIcon from "@/icons/arrow-right.astro";
import GithubIcon from "@/icons/github.astro";
import ShareIcon from "@/icons/share.astro";
import I18n from "@/i18n/index.astro";

//const list = Array.from({ length: 400 }, (_, i) => i);

const { work, es } = Astro.props;
const { title, subtitle, description, url, urlText, tags, skills, github } =
  work.data;

const shareData = {
  title,
  text: description,
  url: Astro.url,
};
---

<header
  class="relative min-h-[100dvh] flex flex-col justify-center text-white hero"
>
  <ScrollDownBanner
    class="absolute top-[100dvh] left-1/2 -translate-x-1/2 -translate-y-full"
    es={es}
  />
  <Container class="pt-[30dvh] pb-[10dvh]">
    <h1 class="text-h1 font-medium leading-none mb-[6dvh] title">
      {title}
    </h1>
    <p class="text-description font-medium mb-[8dvh] px-2 subtitle">
      {subtitle}
    </p>

    <p
      class="text-lead w-2/3 text-balance leading-snug px-2 mb-[10dvh] description"
    >
      {description}
    </p>
    <nav
      class="flex flex-wrap items-center gap-2 mb-[14dvh] nav nav-share"
      data-sharedata={JSON.stringify(shareData)}
    >
      <div>
        <Button
          href={github}
          target="_blank"
          circular
          color="github"
          title="Ver es Github"
        >
          <GithubIcon />
        </Button>
      </div>
      <div>
        <Button
          className="share-btn"
          type="button"
          circular
          color="share"
          title="Compartir"><ShareIcon /></Button
        >
      </div>
      <div>
        <Button href={url} target="_blank">
          <ArrowRightIcon size={16} />{urlText}
        </Button>
      </div>
    </nav>

    <div
      class="flex flex-wrap gap-[7dvw] text-sublead leading-tight px-2 fade-in-b skills"
    >
      <div>
        <h4 class="font-bold mb-[2dvh] uppercase">
          <I18n text="Technologies" es={es} />
        </h4>
        <ul class="flex flex-col gap-[1dvh] capitalize">
          {skills.map((skill) => <li>{skill}</li>)}
        </ul>
      </div>
      <div>
        <h4 class="font-bold mb-[2dvh] uppercase">
          <I18n text="Sectors" es={es} />
        </h4>
        <ul class="flex flex-col gap-[1dvh] capitalize">
          {tags.map((tech) => <li>{tech}</li>)}
        </ul>
      </div>
    </div>
  </Container>
</header>

<style>
  .hero {
    overflow: hidden;
  }

  .title {
    animation: fade-in-trans-anim 0.4s 0.1s both ease-in-out;
  }

  .subtitle {
    animation: fade-in-trans-anim 0.4s 0.3s both ease-in-out;
  }

  .description,
  .nav,
  .skills {
    animation: fade-in-anim both linear;
    animation-timeline: --scroll;
    animation-range: 100dvh 125dvh;
  }

  @keyframes fade-in-trans-anim {
    0% {
      opacity: 0;
      transform: translateY(4vh);
    }
    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }
  @keyframes fade-in-anim {
    0% {
      opacity: 0;
    }
    100% {
      opacity: 1;
    }
  }
</style>

<script>
  import $ from "@/js/utils";

  $.onAstroPageLoad(() => {
    const nav = $.sel(".nav-share");
    const shareBtn = $.sel(".share-btn");

    if (nav && shareBtn) {
      const shareData = JSON.parse(nav.dataset.sharedata);

      $.ev(shareBtn).on("click", async () => {
        try {
          await navigator.share(shareData);
        } catch (err) {}
      });
    }
  });
</script>
