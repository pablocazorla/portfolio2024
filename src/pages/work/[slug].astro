---
import Layout from "@/layouts/Layout.astro";
import { getCollection } from "astro:content";
import Header from "@/components/work-single/header.astro";
import Gallery from "@/components/work-single/gallery.astro";
import Image from "@/components/image/index.astro";
import Backbutton from "@/components/back-button/index.astro";
import dataSite from "@/data/data.json";

export async function getStaticPaths() {
  const portfolioData = await getCollection("portfolio");
  return portfolioData.map((work) => ({
    params: { slug: work.slug },
    props: { work },
  }));
}

const { work } = Astro.props;
const { title, thumbnail } = work.data;

const { title: titleWork, url: urlBase } = dataSite.sitemap.work;
---

<Layout title={`${title} - ${titleWork}`}>
  <Backbutton href={urlBase} text={titleWork} />
  <article class="relative bg-gray-900 portfolio-section">
    <picture
      class="block overflow-hidden absolute top-0 left-0 w-full h-full bg-black select-none bg-portfolio-picture blur-sm"
    >
      <Image
        src="/img/portfolio"
        name={thumbnail}
        alt={title}
        class="object-cover w-full h-full opacity-40"
      />
    </picture>
    <Header work={work} />
    <Gallery work={work} />
  </article>
</Layout>

<style>
  .portfolio-section {
    view-timeline: --scroll;
    overflow: hidden;
  }
  /************* */
  .bg-portfolio-picture {
    animation: bg-hero-picture-displace linear;
    animation-timeline: --scroll;
    animation-range: 100vh 100%;
  }

  @keyframes bg-hero-picture-displace {
    0% {
      transform: translateY(0);
    }
    100% {
      transform: translateY(200vh);
    }
  }

  /************************ */
</style>
